# 闭包和程序块

Ruby的程序块是指在方法调用时，可以追加的代码块，应该在JavaScript语言也有类似的功能

Ruby程序块的功能的原理和高级函数一样，高阶函数是指以函数作为参数的函数。为了实现高阶函数，编程语言中必须把函数和方法作为数据处理。

在c或者Java这类静态语言中，实现函数间的信息传递只有两种方法，要么明确传递参数，要么使用全局变量。如果使用了全局变量来传递信息，就搞不清楚什么时候，谁引用了或者更新这一变量，也不能进行递归调用。

#### 可以保存外部环境的闭包
为了解决这一类问题，JavaScript增加，引用函数外部变量的功能，也就是闭包。

在块中可以引用外部的局部变量的方法，这说明把外部“环境”也包括了进去，像这样的块称为闭包。通常的局部变量在方法执行结束时，就已经不存在了。但是如果被包括在闭包中，那么在闭包存在期间，局部变量也会一直存在。

#### 块在循环（闭包和循环）处理的应用

最典型的用法是，在逐个处理集合对象的元素的方法使用块。

#### 外部迭代，和内部迭代器的优点，缺点

像Ruby这样，把对各个元素处理逻辑传送给容器类的方法，然后在方法中对容器类中每个元素调用指定的处理逻辑，这个迭代方法被称为内部迭代器方式。

与之相对的，C++，和Java中所谓的迭代器，使用别的类对象来循环处理容器中的元素，这种循环处理方式被称为外部迭代器方式，在外部迭代器方式中，把顺序出容器中的元素的对象被称为迭代器，也称为游标

```java
for(Iterator i = arr_names.iterator(); i.hasNext();){
    Object obj = i.next();
    ...;
}
```

内部迭代器实现简单，外部迭代器可以从多个容器中逐个取出数据，并行处理。
从设计模式， 内部迭代器是访问者模式，外部迭代器是迭代器模式。